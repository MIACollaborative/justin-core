## 📚 How to Update the Docs for a New Version

We use Docusaurus versioning to keep the documentation in lock step with the package version in `@just-in/core`. That way, anyone using an older version of the library can view docs that match the API they’re actually using — no surprises.

### 🛠 When to Version the Docs

Whenever we bump the package version (e.g., `0.1.0` → `0.2.0`), we should update and snapshot the current docs. This includes all markdown content (`docs/docs/`).

---

### ♻️ Steps to Version the Docs

From the **project root** (`justin-core`), run:

```bash
yarn version-docs
```

This will:

1. Grab the current version from `package.json`
2. Run `yarn docusaurus docs:version <version>` inside `docs/`
3. Create a frozen copy of the docs under `docs/versioned_docs/version-<version>/`

You’ll also see:

* `versioned_sidebars/version-<version>-sidebars.json`
* `versions.json` updated with the new version

---

### 📆 What Gets Versioned?

* All docs inside `docs/docs/`
* All API markdown generated by TypeDoc (in `docs/docs/typeDoc/`)
* Sidebars, so the navigation stays consistent per version

If you want to include new API symbols or docs in the next version, just edit the files in `docs/docs/` and regenerate `typedoc`. Old versions will remain untouched.

---

### 🧪 Previewing

To check your changes locally:

```bash
cd docs
yarn start
```

You’ll see a version dropdown in the upper-right. “Next” shows the latest edits (unreleased), and past versions like `0.1.0` are locked snapshots.

---

### ✏️ Editing Past Versions?

You usually don’t. But if you absolutely need to patch docs for an old version:

```bash
cd docs/versioned_docs/version-0.1.0
# make your changes here
```

Just be careful — these don’t get regenerated, so it’s all manual.

---

### 🧼 Gotchas to Avoid

* **Docusaurus will not overwrite an existing version.** If the version in `package.json` hasn't changed, `yarn version-docs` will fail with a message like `Tag name already exists.`
  * This will prevent mistakenly overwrite existing documents
* To manually reversion an existing version:

  ```bash
  rm -rf docs/versioned_docs/version-0.1.0
  rm -f docs/versioned_sidebars/version-0.1.0-sidebars.json
  # Then manually remove "0.1.0" from docs/versions.json
  yarn version-docs
  ```
* Always regenerate TypeDoc before versioning:

  ```bash
  yarn docusaurus
  yarn version-docs
  ```

---

### ✨ Recommended Flow While Developing Toward a Release

1. Keep editing `docs/docs/` — this is the "Next" version shown in the docs site.
2. Don’t run `version-docs` until right before tagging and publishing.
3. Optionally wire this to your release process or CI/CD pipeline.

---

### 🏒 Script Reference

In `package.json`, we use:

```json
"scripts": {
  "version-docs": "cd docs && yarn docusaurus docs:version $(node -p \"require('../package.json').version\")"
}
```
